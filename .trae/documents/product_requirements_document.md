# Product Requirements Document - MuscleMetric

## 1. Product Overview
MuscleMetric 是一款专注于力量训练和饮食管理的 iOS 原生应用，旨在帮助用户高效记录训练重量与每日营养摄入。
产品采用“本地优先”策略，所有数据通过 iCloud (CloudKit) 存储与同步，保障用户隐私与数据安全，无需额外注册账号。

## 2. Core Features

### 2.1 User Roles
由于本应用基于 iCloud 个人账户体系，无需独立的用户注册流程。

| Role | Registration Method | Core Permissions |
|------|---------------------|------------------|
| iOS User | iCloud 登录 | 拥有完整的数据创建、编辑、删除及同步权限 |

### 2.2 Feature Module
应用主要包含以下核心页面：
1.  **首页 (Home)**: 导航入口，展示今日概览或快速入口。
2.  **力训记录页 (Strength Record)**: 创建和编辑力量训练记录。
3.  **饮食记录页 (Diet Record)**: 创建和编辑每日饮食营养记录。
4.  **标签管理页 (Tag Management)**: 统一管理力训标签和饮食标签。

### 2.3 Page Details

| Page Name | Module Name | Feature description |
|-----------|-------------|---------------------|
| **首页** | 导航 | 1. 提供进入“力训记录页”和“饮食记录页”的快速入口。<br>2. (可选) 展示最近一条记录的简要信息。 |
| **力训记录页** | 记录基本信息 | 1. 显示当前日期时间。<br>2. 支持自定义记录标题。<br>3. 提供“复制到剪切板”按钮，将本次记录的所有文本信息格式化复制。 |
| | 标签选择与录入 | 1. **必选**第一级标签（健身门店）：选择后锁定上下文，后续仅展示该门店下的子标签。<br>2. 添加第二级标签（器械/动作）及其所属的第三级标签（重量）。<br>3. 支持在一个页面内添加多组动作和重量记录。 |
| **饮食记录页** | 记录基本信息 | 1. 标题默认为当前日期，支持用户编辑。<br>2. 提供“复制到剪切板”按钮，复制所有标签信息及当日概要。 |
| | 营养录入 | 1. 添加饮食标签按钮，从已创建的标签库中选择食物。<br>2. 列表展示已添加的食物标签。 |
| | 当日概要 | 1. 页面底部固定展示统计信息。<br>2. 自动计算并显示：总热量、总蛋白质、总碳水、总脂肪（基于当前页面所有标签的累加值）。 |
| **标签管理页** | 力训标签管理 | 1. 创建/编辑/删除力训标签。<br>2. 维护三级层级关系：一级（门店） -> 二级（器械/动作） -> 三级（重量）。 |
| | 饮食标签管理 | 1. 创建/编辑/删除饮食标签。<br>2. 每个标签必填四项数值：名称、热量、蛋白质、碳水化合物、脂肪。 |

## 3. Core Process

### 用户操作流程

1.  **力训记录流程**: 用户进入力训模块 -> 创建新记录 -> 选择健身门店(锁定) -> 添加具体的动作和重量标签 -> 完成记录 -> (可选)点击复制按钮分享。
2.  **饮食记录流程**: 用户进入饮食模块 -> 创建或打开今日记录 -> 添加食物标签 -> 查看底部自动计算的营养概要 -> (可选)点击复制按钮分享。
3.  **标签创建流程**: 用户在管理页或记录页入口 -> 新建标签 -> 输入名称及属性(层级或营养素) -> 保存。

```mermaid
graph TD
  A[首页] --> B[力训记录页]
  A --> C[饮食记录页]
  A --> D[标签管理页]
  
  B --> B1{选择一级标签(门店)}
  B1 -->|锁定| B2[添加二级/三级标签]
  B2 --> B3[生成文本并复制]
  
  C --> C1[添加饮食标签]
  C1 --> C2[自动更新当日概要]
  C2 --> C3[生成文本并复制]
  
  D --> D1[创建力训层级标签]
  D --> D2[创建饮食营养标签]
```

## 4. User Interface Design

### 4.1 Design Style
*   **平台风格**: 严格遵循 Apple Human Interface Guidelines (HIG)，使用原生 SwiftUI 组件。
*   **色彩**:
    *   主色调：建议使用充满活力的颜色（如系统蓝或健身相关的橙色/绿色）作为强调色。
    *   背景：支持系统深色模式 (Dark Mode) 和浅色模式 (Light Mode)。
*   **布局**:
    *   列表 (List) 和 表单 (Form) 风格为主，便于数据录入。
    *   卡片式设计用于展示“当日概要”等关键信息。
*   **字体**: San Francisco (系统默认字体)，利用不同字重区分标题和正文。

### 4.2 Page Design Overview

| Page Name | Module Name | UI Elements |
|-----------|-------------|-------------|
| 力训记录页 | 头部区域 | 标题输入框(大标题风格)，日期显示(副标题灰色)，右上角“复制”图标按钮。 |
| | 录入区域 | 分组列表(Section)。第一组为一级标签选择器(Picker或NavigationLink)。后续组为动态添加的动作列表。底部有显眼的“+ 添加动作”按钮。 |
| 饮食记录页 | 头部区域 | 标题输入框，日期显示，右上角“复制”按钮。 |
| | 列表区域 | 垂直列表展示已添加的食物，每行显示名称及简要营养数值。 |
| | 底部概要 | 固定底栏 (Bottom Bar) 或 页面底部大卡片，横向排列展示四个核心营养数据（热量/蛋白/碳水/脂肪），字体加粗突出数值。 |
| 标签管理 | 列表 | 分段控件 (Segmented Control) 切换“力训”和“饮食”。列表支持层级展开(OutlineGroup)或导航进入下一级。 |

### 4.3 Responsiveness
*   **设备支持**: iPhone 优先 (Portrait 模式)。
*   **适配**: 使用 SwiftUI 自适应布局，确保在不同尺寸 iPhone 上显示正常。
*   **触控**: 优化点击区域，确保标签选择和按钮点击容易操作。
